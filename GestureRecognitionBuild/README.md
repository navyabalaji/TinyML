# Dual-CPU PSoC6 Gesture Recognition Project — Project Overview

---

## Project Purpose

This project is a **dual-CPU application template for PSoC™ 6 MCUs**. It demonstrates a minimal multicore setup, extended to run a **TensorFlow Lite for Microcontrollers** model for gesture recognition using a camera. The project is designed for hardware with two cores: Cortex-M0+ (CM0+) and Cortex-M4 (CM4).

---

## Top-Level Structure

- **`Makefile`**: Main build file for the application. Defines the project as an "APPLICATION" and lists the two subprojects (`proj_cm0p` and `proj_cm4`).
- **`common.mk`, `common_app.mk`**: Shared makefile fragments for build configuration.
- **`README.md`**: Official documentation on project setup, supported boards, toolchains, and usage.
- **`LICENSE`**: Licensing information.
- **`.gitignore`, `.cyignore`**: Ignore rules for version control and Cypress tools.
- **`requirements.txt`**: Python dependencies, likely for model training or build scripts.

---

## Key Folders and Their Roles

### 1. `src/` — Main Application Source

- **`main.c`**: Main application logic. Initializes hardware, sets up TensorFlow Lite Micro, captures images from a camera, runs inference, and prints detected gestures.
- **`main.h`**: Header for `main.c`, defines constants, includes, and function prototypes.
- **`camera.c`**: Handles camera initialization and image capture (currently with placeholder code).
- **`model_data.c`**: Contains the TensorFlow Lite model as a C array (`model_tflite[]`), generated from the `.tflite` file.
- **`model.tflite`**: The TensorFlow Lite model file, generated by training scripts.

### 2. `model/` — Model Training

- **`train_model.py`**: Python script to download the Sign Language MNIST dataset, preprocess data, train a Keras model, convert it to TFLite (with quantization), and export it for use in the embedded application.

### 3. `proj_cm4/` — Cortex-M4 Project

- **`main.c`**: Minimal code that initializes the board and enters an empty loop. In this template, the main application logic is not here, but in some multicore projects, the CM4 core would run the main application.
- **Other files**: Project configuration, build artifacts, and dependencies for the CM4 core.

### 4. `proj_cm0p/` — Cortex-M0+ Project

- **`main.c`**: Initializes the board, enables the CM4 core, and then enters deep sleep. The CM0+ core is responsible for starting the CM4 core and then idling.
- **Other files**: Project configuration, build artifacts, and dependencies for the CM0+ core.

### 5. `bsps/` — Board Support Packages

- **`TARGET_APP_CY8CKIT-062S2-43012/`**: Contains all the board-specific configuration and source files for the selected hardware target.
  - **`config/`**: Hardware configuration files, including:
    - **`design.modus`**: Main hardware design file (pins, clocks, peripherals).
    - **`GeneratedSource/`**: Auto-generated C source and header files for hardware setup (pins, clocks, peripherals, etc.).
  - **`COMPONENT_CM4/`, `COMPONENT_CM0P/`**: Component-specific files for each core.
  - **`cybsp.c`, `cybsp.h`**: Board support package source and header.
  - **Documentation and legal files**: `README.md`, `RELEASE.md`, `LICENSE`, `EULA`.

### 6. `templates/` — Board/Kit Templates

- Contains subfolders for each supported board/kit, each with template files for project creation or configuration.

### 7. `build/` — Build Artifacts

- **`app_combined.hex`**: Combined hex file for programming both cores.
- **`project_hex/`**: Contains separate hex files for each core (`proj_cm4.hex`, `proj_cm0p.hex`).

### 8. `.mtbLaunchConfigs/` — IDE Launch Configurations

- Contains launch, debug, and erase configurations for use with ModusToolbox or Eclipse IDE.

### 9. `.settings/` — IDE/Tool Settings

- Stores IDE-specific settings (e.g., for Eclipse or ModusToolbox).

---

## How the Project Works

### Multicore Structure

- **CM0+ Core (`proj_cm0p`)**: Initializes the system and enables the CM4 core, then goes to sleep. It does not run the main application logic.
- **CM4 Core (`proj_cm4`)**: In this template, it only initializes the board and idles. However, the main application logic (gesture recognition) is in `src/main.c`, which is likely linked to the CM4 project.

### Gesture Recognition Application

- **Model Training**: The `model/train_model.py` script trains a CNN on the Sign Language MNIST dataset, converts it to TFLite, and exports it as `model.tflite`.
- **Model Integration**: The TFLite model is converted to a C array (`model_data.c`) and included in the embedded application.
- **Image Capture**: The application (in `src/main.c`) initializes the camera, captures images, preprocesses them, and feeds them to the TFLite model.
- **Inference**: The model predicts the gesture, and the result is printed via UART.

### Board Support and Configuration

- All hardware configuration (pins, clocks, peripherals) is managed in the `bsps/` directory, with auto-generated code in `GeneratedSource/`.
- The same configuration is shared by both cores.

---

## Summary Table of Major Files/Folders

| File/Folder                | Purpose                                                                 |
|----------------------------|-------------------------------------------------------------------------|
| `Makefile`                 | Top-level build file for the dual-core application                      |
| `src/`                     | Main application source (gesture recognition, camera, model)            |
| `model/`                   | Model training and export scripts                                       |
| `proj_cm4/`                | Project files for Cortex-M4 core                                        |
| `proj_cm0p/`               | Project files for Cortex-M0+ core                                       |
| `bsps/`                    | Board support package and hardware configuration                        |
| `templates/`               | Templates for supported boards/kits                                     |
| `build/`                   | Build artifacts (hex files, etc.)                                       |
| `.mtbLaunchConfigs/`       | IDE launch/debug configurations                                         |
| `.settings/`               | IDE/tool-specific settings                                              |
| `README.md`                | Project documentation                                                   |
| `LICENSE`                  | Licensing information                                                   |
| `requirements.txt`         | Python dependencies for model training                                  |

---

## How to Extend or Modify

- **To add new hardware features**: Modify the hardware design in `bsps/TARGET_APP_.../config/design.modus` and regenerate sources.
- **To change the model**: Edit and run `model/train_model.py`, then update the embedded model.
- **To add application logic**: Edit `src/main.c` and related files.


